import{d as B,y as E,X as $,i as v,f as d,K as z,o as y,c as K,h as q,w as F,a as k,n as u,b as M,q as V,t as G,G as X,Y,Z,_ as j}from"./index-619e6e2b.js";const H=["data-node-tree"],J=B({__name:"AppNodeTree",props:{scrollRef:{}},setup(w){const f=w,{getCurrentSelectedNodeId:D,setCurrentSelectedNodeId:I}=E(),{bodyNode:p,getNodePaths:_,checkAllowInsert:m,checkAllowInsertPrev:x,checkAllowInsertNext:g}=$(),c=v(null),b=d(()=>p.value?[p.value]:[]),l=e=>e,o=v(new Set),N=d(()=>[...o.value].filter((e,t,n)=>_(e).map(a=>a.instanceID).every(a=>n.includes(a)))),C=(e,{data:t})=>{o.value.add(t.instanceID)},R=(e,{data:t})=>{o.value.delete(t.instanceID)},s=d({get:()=>D()||void 0,set:e=>I(e||"")}),A=e=>{if(!f.scrollRef)return;const{wrapRef:t,setScrollTop:n}=f.scrollRef;if(!t)return;const r=t.querySelector(`[data-node-tree="${e}"]`);if(!r)return;const a=t.getBoundingClientRect(),h=r.getBoundingClientRect(),i=h.top-a.top;i>=0&&a.height>=i+h.height||n(i+t.scrollTop)},S=e=>{s.value=(e==null?void 0:e.instanceID)||"",e!=null&&e.instanceID&&Z(100).then(()=>{A(e.instanceID)})};z([s],()=>{const e=s.value;e&&_(e).forEach(n=>o.value.add(n.instanceID)),c.value&&c.value.setCurrentKey(e)},{immediate:!0});const P=e=>e.data.allowDrag,T=(e,t,n)=>n==="inner"?m(e.data,t.data):n==="next"?g(e.data,t.data):n==="prev"?x(e.data,t.data):!1;return(e,t)=>(y(),K("div",{class:u(e.$style.box)},[(y(),q(X(Y),{ref_key:"treeRef",ref:c,key:s.value,data:b.value,props:{label:"instanceName",children:"nodes"},"default-expanded-keys":N.value,"expand-on-click-node":!1,"check-on-click-node":!0,"highlight-current":!0,"current-node-key":s.value,draggable:!0,"allow-drag":P,"allow-drop":T,"node-key":"instanceID",onNodeExpand:C,onNodeCollapse:R,onCurrentChange:S},{default:F(({data:n})=>[k("div",{class:u(e.$style.info),"data-node-tree":l(n).instanceID},[M(V,{class:u(e.$style.info_icon),icon:l(n).basicInfo.icon},null,8,["class","icon"]),k("span",null,G(l(n).instanceName),1)],10,H)]),_:1},8,["data","default-expanded-keys","current-node-key"]))],2))}}),L="_box_1z01b_1",O="_info_1z01b_5",Q="_info_icon_1z01b_11",U={box:L,info:O,info_icon:Q},W={$style:U},ne=j(J,[["__cssModules",W]]);export{ne as default};
